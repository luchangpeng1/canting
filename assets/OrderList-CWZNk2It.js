import{a0 as $,a1 as q,g as B,a2 as ie,o as se,H as Z,_ as ue,a3 as fe,b as he,a4 as ve,a5 as me,r as ge,P as pe,a6 as _e,a7 as we,a8 as Ce,a9 as ye,j as Ee,V as ae,E as Q,k as x,n as f,v as z,q as m,w as C,A as K,aa as Me,x as b,y as O,B as F,z as W,X as j,I as oe,C as Re}from"./index-1A1V_OG6.js";/*!
 * qrcode.vue v3.6.0
 * A Vue.js component to generate QRCode. Both support Vue 2 and Vue 3
 * © 2017-PRESENT @scopewu(https://github.com/scopewu)
 * MIT License.
 */var H=function(){return H=Object.assign||function(o){for(var u,i=1,v=arguments.length;i<v;i++){u=arguments[i];for(var g in u)Object.prototype.hasOwnProperty.call(u,g)&&(o[g]=u[g])}return o},H.apply(this,arguments)};var Y;(function(s){var o=function(){function n(e,t,r,a){if(this.version=e,this.errorCorrectionLevel=t,this.modules=[],this.isFunction=[],e<n.MIN_VERSION||e>n.MAX_VERSION)throw new RangeError("Version value out of range");if(a<-1||a>7)throw new RangeError("Mask value out of range");this.size=e*4+17;for(var d=[],l=0;l<this.size;l++)d.push(!1);for(var l=0;l<this.size;l++)this.modules.push(d.slice()),this.isFunction.push(d.slice());this.drawFunctionPatterns();var h=this.addEccAndInterleave(r);if(this.drawCodewords(h),a==-1)for(var y=1e9,l=0;l<8;l++){this.applyMask(l),this.drawFormatBits(l);var S=this.getPenaltyScore();S<y&&(a=l,y=S),this.applyMask(l)}v(0<=a&&a<=7),this.mask=a,this.applyMask(a),this.drawFormatBits(a),this.isFunction=[]}return n.encodeText=function(e,t){var r=s.QrSegment.makeSegments(e);return n.encodeSegments(r,t)},n.encodeBinary=function(e,t){var r=s.QrSegment.makeBytes(e);return n.encodeSegments([r],t)},n.encodeSegments=function(e,t,r,a,d,l){if(r===void 0&&(r=1),a===void 0&&(a=40),d===void 0&&(d=-1),l===void 0&&(l=!0),!(n.MIN_VERSION<=r&&r<=a&&a<=n.MAX_VERSION)||d<-1||d>7)throw new RangeError("Invalid value");var h,y;for(h=r;;h++){var S=n.getNumDataCodewords(h,t)*8,M=g.getTotalBits(e,h);if(M<=S){y=M;break}if(h>=a)throw new RangeError("Data too long")}for(var R=0,P=[n.Ecc.MEDIUM,n.Ecc.QUARTILE,n.Ecc.HIGH];R<P.length;R++){var E=P[R];l&&y<=n.getNumDataCodewords(h,E)*8&&(t=E)}for(var w=[],N=0,A=e;N<A.length;N++){var T=A[N];u(T.mode.modeBits,4,w),u(T.numChars,T.mode.numCharCountBits(h),w);for(var L=0,k=T.getData();L<k.length;L++){var G=k[L];w.push(G)}}v(w.length==y);var U=n.getNumDataCodewords(h,t)*8;v(w.length<=U),u(0,Math.min(4,U-w.length),w),u(0,(8-w.length%8)%8,w),v(w.length%8==0);for(var I=236;w.length<U;I^=253)u(I,8,w);for(var D=[];D.length*8<w.length;)D.push(0);return w.forEach(function(p,c){return D[c>>>3]|=p<<7-(c&7)}),new n(h,t,D,d)},n.prototype.getModule=function(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]},n.prototype.getModules=function(){return this.modules},n.prototype.drawFunctionPatterns=function(){for(var e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);for(var t=this.getAlignmentPatternPositions(),r=t.length,e=0;e<r;e++)for(var a=0;a<r;a++)e==0&&a==0||e==0&&a==r-1||e==r-1&&a==0||this.drawAlignmentPattern(t[e],t[a]);this.drawFormatBits(0),this.drawVersion()},n.prototype.drawFormatBits=function(e){for(var t=this.errorCorrectionLevel.formatBits<<3|e,r=t,a=0;a<10;a++)r=r<<1^(r>>>9)*1335;var d=(t<<10|r)^21522;v(d>>>15==0);for(var a=0;a<=5;a++)this.setFunctionModule(8,a,i(d,a));this.setFunctionModule(8,7,i(d,6)),this.setFunctionModule(8,8,i(d,7)),this.setFunctionModule(7,8,i(d,8));for(var a=9;a<15;a++)this.setFunctionModule(14-a,8,i(d,a));for(var a=0;a<8;a++)this.setFunctionModule(this.size-1-a,8,i(d,a));for(var a=8;a<15;a++)this.setFunctionModule(8,this.size-15+a,i(d,a));this.setFunctionModule(8,this.size-8,!0)},n.prototype.drawVersion=function(){if(!(this.version<7)){for(var e=this.version,t=0;t<12;t++)e=e<<1^(e>>>11)*7973;var r=this.version<<12|e;v(r>>>18==0);for(var t=0;t<18;t++){var a=i(r,t),d=this.size-11+t%3,l=Math.floor(t/3);this.setFunctionModule(d,l,a),this.setFunctionModule(l,d,a)}}},n.prototype.drawFinderPattern=function(e,t){for(var r=-4;r<=4;r++)for(var a=-4;a<=4;a++){var d=Math.max(Math.abs(a),Math.abs(r)),l=e+a,h=t+r;0<=l&&l<this.size&&0<=h&&h<this.size&&this.setFunctionModule(l,h,d!=2&&d!=4)}},n.prototype.drawAlignmentPattern=function(e,t){for(var r=-2;r<=2;r++)for(var a=-2;a<=2;a++)this.setFunctionModule(e+a,t+r,Math.max(Math.abs(a),Math.abs(r))!=1)},n.prototype.setFunctionModule=function(e,t,r){this.modules[t][e]=r,this.isFunction[t][e]=!0},n.prototype.addEccAndInterleave=function(e){var t=this.version,r=this.errorCorrectionLevel;if(e.length!=n.getNumDataCodewords(t,r))throw new RangeError("Invalid argument");for(var a=n.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][t],d=n.ECC_CODEWORDS_PER_BLOCK[r.ordinal][t],l=Math.floor(n.getNumRawDataModules(t)/8),h=a-l%a,y=Math.floor(l/a),S=[],M=n.reedSolomonComputeDivisor(d),R=0,P=0;R<a;R++){var E=e.slice(P,P+y-d+(R<h?0:1));P+=E.length;var w=n.reedSolomonComputeRemainder(E,M);R<h&&E.push(0),S.push(E.concat(w))}for(var N=[],A=function(T){S.forEach(function(L,k){(T!=y-d||k>=h)&&N.push(L[T])})},R=0;R<S[0].length;R++)A(R);return v(N.length==l),N},n.prototype.drawCodewords=function(e){if(e.length!=Math.floor(n.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var t=0,r=this.size-1;r>=1;r-=2){r==6&&(r=5);for(var a=0;a<this.size;a++)for(var d=0;d<2;d++){var l=r-d,h=(r+1&2)==0,y=h?this.size-1-a:a;!this.isFunction[y][l]&&t<e.length*8&&(this.modules[y][l]=i(e[t>>>3],7-(t&7)),t++)}}v(t==e.length*8)},n.prototype.applyMask=function(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(var t=0;t<this.size;t++)for(var r=0;r<this.size;r++){var a=void 0;switch(e){case 0:a=(r+t)%2==0;break;case 1:a=t%2==0;break;case 2:a=r%3==0;break;case 3:a=(r+t)%3==0;break;case 4:a=(Math.floor(r/3)+Math.floor(t/2))%2==0;break;case 5:a=r*t%2+r*t%3==0;break;case 6:a=(r*t%2+r*t%3)%2==0;break;case 7:a=((r+t)%2+r*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][r]&&a&&(this.modules[t][r]=!this.modules[t][r])}},n.prototype.getPenaltyScore=function(){for(var e=0,t=0;t<this.size;t++){for(var r=!1,a=0,d=[0,0,0,0,0,0,0],l=0;l<this.size;l++)this.modules[t][l]==r?(a++,a==5?e+=n.PENALTY_N1:a>5&&e++):(this.finderPenaltyAddHistory(a,d),r||(e+=this.finderPenaltyCountPatterns(d)*n.PENALTY_N3),r=this.modules[t][l],a=1);e+=this.finderPenaltyTerminateAndCount(r,a,d)*n.PENALTY_N3}for(var l=0;l<this.size;l++){for(var r=!1,h=0,d=[0,0,0,0,0,0,0],t=0;t<this.size;t++)this.modules[t][l]==r?(h++,h==5?e+=n.PENALTY_N1:h>5&&e++):(this.finderPenaltyAddHistory(h,d),r||(e+=this.finderPenaltyCountPatterns(d)*n.PENALTY_N3),r=this.modules[t][l],h=1);e+=this.finderPenaltyTerminateAndCount(r,h,d)*n.PENALTY_N3}for(var t=0;t<this.size-1;t++)for(var l=0;l<this.size-1;l++){var y=this.modules[t][l];y==this.modules[t][l+1]&&y==this.modules[t+1][l]&&y==this.modules[t+1][l+1]&&(e+=n.PENALTY_N2)}for(var S=0,M=0,R=this.modules;M<R.length;M++){var P=R[M];S=P.reduce(function(N,A){return N+(A?1:0)},S)}var E=this.size*this.size,w=Math.ceil(Math.abs(S*20-E*10)/E)-1;return v(0<=w&&w<=9),e+=w*n.PENALTY_N4,v(0<=e&&e<=2568888),e},n.prototype.getAlignmentPatternPositions=function(){if(this.version==1)return[];for(var e=Math.floor(this.version/7)+2,t=Math.floor((this.version*8+e*3+5)/(e*4-4))*2,r=[6],a=this.size-7;r.length<e;a-=t)r.splice(1,0,a);return r},n.getNumRawDataModules=function(e){if(e<n.MIN_VERSION||e>n.MAX_VERSION)throw new RangeError("Version number out of range");var t=(16*e+128)*e+64;if(e>=2){var r=Math.floor(e/7)+2;t-=(25*r-10)*r-55,e>=7&&(t-=36)}return v(208<=t&&t<=29648),t},n.getNumDataCodewords=function(e,t){return Math.floor(n.getNumRawDataModules(e)/8)-n.ECC_CODEWORDS_PER_BLOCK[t.ordinal][e]*n.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][e]},n.reedSolomonComputeDivisor=function(e){if(e<1||e>255)throw new RangeError("Degree out of range");for(var t=[],r=0;r<e-1;r++)t.push(0);t.push(1);for(var a=1,r=0;r<e;r++){for(var d=0;d<t.length;d++)t[d]=n.reedSolomonMultiply(t[d],a),d+1<t.length&&(t[d]^=t[d+1]);a=n.reedSolomonMultiply(a,2)}return t},n.reedSolomonComputeRemainder=function(e,t){for(var r=t.map(function(y){return 0}),a=function(y){var S=y^r.shift();r.push(0),t.forEach(function(M,R){return r[R]^=n.reedSolomonMultiply(M,S)})},d=0,l=e;d<l.length;d++){var h=l[d];a(h)}return r},n.reedSolomonMultiply=function(e,t){if(e>>>8||t>>>8)throw new RangeError("Byte out of range");for(var r=0,a=7;a>=0;a--)r=r<<1^(r>>>7)*285,r^=(t>>>a&1)*e;return v(r>>>8==0),r},n.prototype.finderPenaltyCountPatterns=function(e){var t=e[1];v(t<=this.size*3);var r=t>0&&e[2]==t&&e[3]==t*3&&e[4]==t&&e[5]==t;return(r&&e[0]>=t*4&&e[6]>=t?1:0)+(r&&e[6]>=t*4&&e[0]>=t?1:0)},n.prototype.finderPenaltyTerminateAndCount=function(e,t,r){return e&&(this.finderPenaltyAddHistory(t,r),t=0),t+=this.size,this.finderPenaltyAddHistory(t,r),this.finderPenaltyCountPatterns(r)},n.prototype.finderPenaltyAddHistory=function(e,t){t[0]==0&&(e+=this.size),t.pop(),t.unshift(e)},n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],n}();s.QrCode=o;function u(n,e,t){if(e<0||e>31||n>>>e)throw new RangeError("Value out of range");for(var r=e-1;r>=0;r--)t.push(n>>>r&1)}function i(n,e){return(n>>>e&1)!=0}function v(n){if(!n)throw new Error("Assertion error")}var g=function(){function n(e,t,r){if(this.mode=e,this.numChars=t,this.bitData=r,t<0)throw new RangeError("Invalid argument");this.bitData=r.slice()}return n.makeBytes=function(e){for(var t=[],r=0,a=e;r<a.length;r++){var d=a[r];u(d,8,t)}return new n(n.Mode.BYTE,e.length,t)},n.makeNumeric=function(e){if(!n.isNumeric(e))throw new RangeError("String contains non-numeric characters");for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,3);u(parseInt(e.substring(r,r+a),10),a*3+1,t),r+=a}return new n(n.Mode.NUMERIC,e.length,t)},n.makeAlphanumeric=function(e){if(!n.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");var t=[],r;for(r=0;r+2<=e.length;r+=2){var a=n.ALPHANUMERIC_CHARSET.indexOf(e.charAt(r))*45;a+=n.ALPHANUMERIC_CHARSET.indexOf(e.charAt(r+1)),u(a,11,t)}return r<e.length&&u(n.ALPHANUMERIC_CHARSET.indexOf(e.charAt(r)),6,t),new n(n.Mode.ALPHANUMERIC,e.length,t)},n.makeSegments=function(e){return e==""?[]:n.isNumeric(e)?[n.makeNumeric(e)]:n.isAlphanumeric(e)?[n.makeAlphanumeric(e)]:[n.makeBytes(n.toUtf8ByteArray(e))]},n.makeEci=function(e){var t=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)u(e,8,t);else if(e<16384)u(2,2,t),u(e,14,t);else if(e<1e6)u(6,3,t),u(e,21,t);else throw new RangeError("ECI assignment value out of range");return new n(n.Mode.ECI,0,t)},n.isNumeric=function(e){return n.NUMERIC_REGEX.test(e)},n.isAlphanumeric=function(e){return n.ALPHANUMERIC_REGEX.test(e)},n.prototype.getData=function(){return this.bitData.slice()},n.getTotalBits=function(e,t){for(var r=0,a=0,d=e;a<d.length;a++){var l=d[a],h=l.mode.numCharCountBits(t);if(l.numChars>=1<<h)return 1/0;r+=4+h+l.bitData.length}return r},n.toUtf8ByteArray=function(e){e=encodeURI(e);for(var t=[],r=0;r<e.length;r++)e.charAt(r)!="%"?t.push(e.charCodeAt(r)):(t.push(parseInt(e.substring(r+1,r+3),16)),r+=2);return t},n.NUMERIC_REGEX=/^[0-9]*$/,n.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,n.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",n}();s.QrSegment=g})(Y||(Y={}));(function(s){(function(o){var u=function(){function i(v,g){this.ordinal=v,this.formatBits=g}return i.LOW=new i(0,1),i.MEDIUM=new i(1,0),i.QUARTILE=new i(2,3),i.HIGH=new i(3,2),i}();o.Ecc=u})(s.QrCode||(s.QrCode={}))})(Y||(Y={}));(function(s){(function(o){var u=function(){function i(v,g){this.modeBits=v,this.numBitsCharCount=g}return i.prototype.numCharCountBits=function(v){return this.numBitsCharCount[Math.floor((v+7)/17)]},i.NUMERIC=new i(1,[10,12,14]),i.ALPHANUMERIC=new i(2,[9,11,13]),i.BYTE=new i(4,[8,16,16]),i.KANJI=new i(8,[8,10,12]),i.ECI=new i(7,[0,0,0]),i}();o.Mode=u})(s.QrSegment||(s.QrSegment={}))})(Y||(Y={}));var X=Y,ee="L",te={L:X.QrCode.Ecc.LOW,M:X.QrCode.Ecc.MEDIUM,Q:X.QrCode.Ecc.QUARTILE,H:X.QrCode.Ecc.HIGH},Ne=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function re(s){return s in te}function le(s,o){o===void 0&&(o=0);var u=[];return s.forEach(function(i,v){var g=null;i.forEach(function(n,e){if(!n&&g!==null){u.push("M".concat(g+o," ").concat(v+o,"h").concat(e-g,"v1H").concat(g+o,"z")),g=null;return}if(e===i.length-1){if(!n)return;g===null?u.push("M".concat(e+o,",").concat(v+o," h1v1H").concat(e+o,"z")):u.push("M".concat(g+o,",").concat(v+o," h").concat(e+1-g,"v1H").concat(g+o,"z"));return}n&&g===null&&(g=e)})}),u.join("")}function de(s,o,u,i){var v=i.width,g=i.height,n=i.x,e=i.y,t=s.length+u*2,r=Math.floor(o*.1),a=t/o,d=(v||r)*a,l=(g||r)*a,h=n==null?s.length/2-d/2:n*a,y=e==null?s.length/2-l/2:e*a,S=null;if(i.excavate){var M=Math.floor(h),R=Math.floor(y),P=Math.ceil(d+h-M),E=Math.ceil(l+y-R);S={x:M,y:R,w:P,h:E}}return{x:h,y,h:l,w:d,excavation:S}}function ce(s,o){return s.slice().map(function(u,i){return i<o.y||i>=o.y+o.h?u:u.map(function(v,g){return g<o.x||g>=o.x+o.w?v:!1})})}var ne={value:{type:String,required:!0,default:""},size:{type:Number,default:100},level:{type:String,default:ee,validator:function(s){return re(s)}},background:{type:String,default:"#fff"},foreground:{type:String,default:"#000"},margin:{type:Number,required:!1,default:0},imageSettings:{type:Object,required:!1,default:function(){return{}}},gradient:{type:Boolean,required:!1,default:!1},gradientType:{type:String,required:!1,default:"linear",validator:function(s){return["linear","radial"].indexOf(s)>-1}},gradientStartColor:{type:String,required:!1,default:"#000"},gradientEndColor:{type:String,required:!1,default:"#fff"}},be=H(H({},ne),{renderAs:{type:String,required:!1,default:"canvas",validator:function(s){return["canvas","svg"].indexOf(s)>-1}}}),Se=$({name:"QRCodeSvg",props:ne,setup:function(s){var o=B(0),u=B(""),i,v=function(){var n=s.value,e=s.level,t=s.margin,r=t>>>0,a=re(e)?e:ee,d=X.QrCode.encodeText(n,te[a]).getModules();if(o.value=d.length+r*2,s.imageSettings.src){var l=de(d,s.size,r,s.imageSettings);i={x:l.x+r,y:l.y+r,width:l.w,height:l.h},l.excavation&&(d=ce(d,l.excavation))}u.value=le(d,r)},g=function(){if(!s.gradient)return null;var n=s.gradientType==="linear"?{x1:"0%",y1:"0%",x2:"100%",y2:"100%"}:{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"};return q(s.gradientType==="linear"?"linearGradient":"radialGradient",H({id:"qr-gradient"},n),[q("stop",{offset:"0%",style:{stopColor:s.gradientStartColor}}),q("stop",{offset:"100%",style:{stopColor:s.gradientEndColor}})])};return v(),ie(v),function(){return q("svg",{width:s.size,height:s.size,"shape-rendering":"crispEdges",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(o.value," ").concat(o.value)},[q("defs",{},[g()]),q("rect",{width:"100%",height:"100%",fill:s.background}),q("path",{fill:s.gradient?"url(#qr-gradient)":s.foreground,d:u.value}),s.imageSettings.src&&q("image",H({href:s.imageSettings.src},i))])}}}),Pe=$({name:"QRCodeCanvas",props:ne,setup:function(s,o){var u=B(null),i=B(null),v=function(){var n=s.value,e=s.level,t=s.size,r=s.margin,a=s.background,d=s.foreground,l=s.gradient,h=s.gradientType,y=s.gradientStartColor,S=s.gradientEndColor,M=r>>>0,R=re(e)?e:ee,P=u.value;if(P){var E=P.getContext("2d");if(E){var w=X.QrCode.encodeText(n,te[R]).getModules(),N=w.length+M*2,A=i.value,T={x:0,y:0,width:0,height:0},L=s.imageSettings.src&&A!=null&&A.naturalWidth!==0&&A.naturalHeight!==0;if(L){var k=de(w,s.size,M,s.imageSettings);T={x:k.x+M,y:k.y+M,width:k.w,height:k.h},k.excavation&&(w=ce(w,k.excavation))}var G=window.devicePixelRatio||1,U=t/N*G;if(P.height=P.width=t*G,E.scale(U,U),E.fillStyle=a,E.fillRect(0,0,N,N),l){var I=void 0;h==="linear"?I=E.createLinearGradient(0,0,N,N):I=E.createRadialGradient(N/2,N/2,0,N/2,N/2,N/2),I.addColorStop(0,y),I.addColorStop(1,S),E.fillStyle=I}else E.fillStyle=d;Ne?E.fill(new Path2D(le(w,M))):w.forEach(function(D,p){D.forEach(function(c,_){c&&E.fillRect(_+M,p+M,1,1)})}),L&&E.drawImage(A,T.x,T.y,T.width,T.height)}}};se(v),ie(v);var g=o.attrs.style;return function(){return q(Z,[q("canvas",H(H({},o.attrs),{ref:u,style:H(H({},g),{width:"".concat(s.size,"px"),height:"".concat(s.size,"px")})})),s.imageSettings.src&&q("img",{ref:i,src:s.imageSettings.src,style:{display:"none"},onLoad:v})])}}}),Te=$({name:"Qrcode",render:function(){var s=this.$props,o=s.renderAs,u=s.value,i=s.size,v=s.margin,g=s.level,n=s.background,e=s.foreground,t=s.imageSettings,r=s.gradient,a=s.gradientType,d=s.gradientStartColor,l=s.gradientEndColor;return q(o==="svg"?Se:Pe,{value:u,size:i,margin:v,level:g,background:n,foreground:e,imageSettings:t,gradient:r,gradientType:a,gradientStartColor:d,gradientEndColor:l})},props:be});const ke={name:"OrderList",components:{Calendar:fe,Shop:he,TakeawayBox:ve,Check:me,Refresh:ge,Timer:pe,ArrowRight:_e,Bell:we,QrcodeVue:Te,Ticket:Ce,Tools:ye},setup(){const s=Re(),o=B("ongoing"),u=B([]),i=B([]),v=[{id:1,windowName:"特色炒菜",status:"preparing",dishes:[{id:1,name:"宫保鸡丁",quantity:1,price:15},{id:2,name:"青椒肉丝",quantity:1,price:12}],totalPrice:27,createTime:"2024-01-20 12:30:00",pickupLocation:"一楼3号窗口",estimatedTime:"5"},{id:2,windowName:"面食档口",status:"preparing",dishes:[{id:3,name:"牛肉面",quantity:1,price:18},{id:4,name:"煎蛋",quantity:1,price:2}],totalPrice:20,createTime:"2024-01-20 12:35:00",pickupLocation:"一楼1号窗口",estimatedTime:"10"},{id:3,windowName:"盖浇饭窗口",status:"ready",dishes:[{id:5,name:"红烧排骨饭",quantity:1,price:22}],totalPrice:22,createTime:"2024-01-20 12:25:00",pickupLocation:"一楼2号窗口",pickupCode:"B789"},{id:4,windowName:"特色炒菜",status:"completed",dishes:[{id:6,name:"鱼香肉丝",quantity:1,price:16},{id:7,name:"蒜蓉空心菜",quantity:1,price:8}],totalPrice:24,createTime:"2024-01-20 11:30:00",pickupLocation:"一楼3号窗口",completedTime:"2024-01-20 11:50:00"},{id:5,windowName:"面食档口",status:"cancelled",dishes:[{id:8,name:"阳春面",quantity:1,price:12}],totalPrice:12,createTime:"2024-01-20 11:20:00",cancelTime:"2024-01-20 11:22:00",cancelReason:"已过午餐时间"}],g=c=>({ordered:"info",preparing:"primary",ready:"success",completed:"info",cancelled:"danger"})[c]||"info",n=c=>({ordered:"已接单",preparing:"制作中",ready:"待取餐",completed:"已完成",cancelled:"已取消"})[c]||"未知状态",e=()=>{s.push("/student/order-history")},t=async()=>{try{"Notification"in window&&await Notification.requestPermission()==="denied"&&Q({message:"为了及时收到取餐通知，建议您允许通知权限",type:"warning",duration:5e3,showClose:!0})}catch(c){console.warn("通知权限请求失败:",c)}};se(()=>{u.value=v.filter(c=>["ordered","preparing","ready"].includes(c.status)),i.value=v.filter(c=>["completed","cancelled"].includes(c.status)),setInterval(G,3e4),document.addEventListener("test-notification",I),document.addEventListener("test-vibration",D),localStorage.getItem("notificationRequested")!=="true"&&(t(),localStorage.setItem("notificationRequested","true"))}),Ee(()=>{clearInterval(G),document.removeEventListener("test-notification",I),document.removeEventListener("test-vibration",D)});const r=c=>({ordered:1,preparing:2,ready:3,completed:3})[c]||0,a=B("all"),d=B(""),l=B(null),h=ae(()=>{let c=u.value;if(a.value!=="all"&&(c=c.filter(_=>_.status===a.value)),d.value){const _=d.value.toLowerCase();c=c.filter(V=>V.windowName.toLowerCase().includes(_)||V.dishes.some(J=>J.name.toLowerCase().includes(_)))}return c}),y=ae(()=>u.value.some(c=>c.status==="ready")),S=async()=>{Q.success("订单已更新")},M=()=>{l.value&&l.value.$el.scrollIntoView({behavior:"smooth",block:"center"})},R=()=>{s.push("/student/home")},P=c=>{if(!c)return"";const _={orderId:c.id,userId:localStorage.getItem("userId"),windowId:c.windowId,timestamp:new Date(c.createTime).getTime(),dishes:c.dishes.map(J=>({id:J.id,name:J.name,quantity:J.quantity}))},V=`${_.orderId}-${_.timestamp}-${_.userId}`;return _.sign=V,JSON.stringify(_)},E=B(!1),w=B(null),N=c=>{w.value=c,E.value=!0},A=async c=>{try{await new Promise(V=>setTimeout(V,1e3)),Q.success("订单已取消");const _=u.value.findIndex(V=>V.id===c.id);_!==-1&&(u.value[_].status="cancelled",i.value.push(u.value[_]),u.value.splice(_,1))}catch{Q.error("取消订单失败，请重试")}},T=c=>{c.status==="ready"&&(L(c),k(),Q({message:"您的餐品已准备就绪，请及时取餐！",type:"success",duration:5e3,showClose:!0,customClass:"ready-notification"}))},L=c=>{"Notification"in window&&Notification.requestPermission().then(_=>{_==="granted"&&new Notification("餐品已准备就绪",{body:`您在${c.windowName}的餐品已准备完成，请及时取餐`,icon:"/favicon.ico",tag:"food-ready",renotify:!0})})},k=()=>{"vibrate"in navigator&&navigator.vibrate([200,100,200])},G=()=>{const c=u.value.filter(_=>_.status==="preparing");if(c.length>0){const _=c[Math.floor(Math.random()*c.length)];_.status="ready",T(_)}},U=B(!1),I=()=>{"Notification"in window&&Notification.requestPermission().then(c=>{c==="granted"?Q.success("测试：通知权限已获取"):Q.warning("测试：请允许通知权限以接收提醒")})},D=()=>{"vibrate"in navigator?(navigator.vibrate([200,100,200]),Q.success("测试：设备震动测试")):Q.warning("测试：当前设备不支持震动功能")};return{activeTab:o,ongoingOrders:u,completedOrders:i,getStatusType:g,getStatusText:n,goToHistory:e,getProgressStep:r,orderFilter:a,searchKeyword:d,filteredOngoingOrders:h,hasReadyOrder:y,refreshOrders:S,scrollToReadyOrder:M,goToHome:R,readyOrderRef:l,generateQRValue:P,qrDialogVisible:E,currentOrder:w,showQRCode:N,cancelOrder:A,testFeatures:()=>{const c=()=>{const _=u.value.find(V=>V.status==="preparing");_&&(_.status="ready",T(_),Q.success("测试：订单状态已更新为待取餐"))};Me.confirm(`请选择要测试的功能：

1. 测试订单状态变更和提醒
2. 测试通知权限
3. 测试设备震动
`,"功能测试",{confirmButtonText:"测试状态变更",cancelButtonText:"取消",distinguishCancelAndClose:!0,showClose:!0,closeOnClickModal:!1,customClass:"test-dialog"}).then(()=>{c()}).catch(_=>{}),Q({message:"点击测试其他功能",type:"info",duration:5e3,showClose:!0,customClass:"test-message",dangerouslyUseHTMLString:!0,message:`
          <div class="test-buttons">
            <button onclick="document.dispatchEvent(new CustomEvent('test-notification'))">
              测试通知
            </button>
            <button onclick="document.dispatchEvent(new CustomEvent('test-vibration'))">
              测试震动
            </button>
          </div>
        `})},isDevelopment:U,testNotification:I,testVibration:D}}},Oe={class:"order-list"},Ae={class:"page-header"},Ie={class:"header-left"},Le={class:"order-stats"},ze={class:"stat-card"},Be={class:"stat-item"},De={class:"stat-card"},Fe={class:"stat-item"},qe={class:"header-actions"},Qe={key:0,class:"order-alert"},Ue={class:"alert-content"},Ve={class:"filter-bar"},xe={class:"order-grid"},He={class:"order-header"},Ge={class:"window-info"},Ke={class:"window-name"},Ye={class:"order-time"},We={class:"order-content"},Xe={class:"dish-list"},Je={class:"dish-image"},Ze=["src","alt"],je={class:"dish-content"},$e={class:"dish-info"},et={class:"dish-name-wrapper"},tt={class:"dish-name"},rt={class:"dish-price-wrapper"},nt={class:"dish-quantity"},at={class:"dish-price"},ot={key:0,class:"order-progress"},it={class:"order-footer"},st={class:"price-info"},lt={class:"total-price"},dt={class:"actions"},ct={key:0,class:"waiting-time"},ut={key:1,class:"pickup-info"},ft={class:"pickup-header"},ht={class:"pickup-location"},vt={class:"qr-dialog-content"},mt={class:"qr-code-container"},gt={class:"qr-info"},pt={class:"window-name"},_t={class:"pickup-location"},wt={class:"qr-tip"},Ct={key:1,class:"test-button"};function yt(s,o,u,i,v,g){const n=b("Refresh"),e=b("el-icon"),t=b("el-button"),r=b("Calendar"),a=b("ArrowRight"),d=b("el-alert"),l=b("el-radio-button"),h=b("el-radio-group"),y=b("el-input"),S=b("TakeawayBox"),M=b("el-empty"),R=b("Shop"),P=b("el-step"),E=b("el-steps"),w=b("el-popconfirm"),N=b("Timer"),A=b("Bell"),T=b("Ticket"),L=b("el-card"),k=b("el-tab-pane"),G=b("el-tabs"),U=b("qrcode-vue"),I=b("el-dialog"),D=b("Tools");return O(),x("div",Oe,[f("div",Ae,[f("div",Ie,[o[8]||(o[8]=f("h2",{class:"page-title"},"我的订单",-1)),f("div",Le,[f("div",ze,[f("span",Be,[f("strong",null,z(i.ongoingOrders.length),1),o[4]||(o[4]=f("span",null,"进行中",-1)),o[5]||(o[5]=f("small",null,"预计15分钟内可取餐",-1))])]),f("div",De,[f("span",Fe,[f("strong",null,z(i.completedOrders.length),1),o[6]||(o[6]=f("span",null,"已完成",-1)),o[7]||(o[7]=f("small",null,"本周已完成订单",-1))])])])]),f("div",qe,[m(t,{class:"refresh-btn",onClick:i.refreshOrders},{default:C(()=>[m(e,null,{default:C(()=>[m(n)]),_:1}),o[9]||(o[9]=F(" 刷新 "))]),_:1},8,["onClick"]),m(t,{type:"primary",class:"history-btn",onClick:i.goToHistory},{default:C(()=>[m(e,null,{default:C(()=>[m(r)]),_:1}),o[10]||(o[10]=F(" 历史订单 "))]),_:1},8,["onClick"])])]),i.hasReadyOrder?(O(),x("div",Qe,[m(d,{type:"success","show-icon":"",closable:!1},{title:C(()=>[f("span",Ue,[o[12]||(o[12]=F(" 您有订单可以取餐啦！请尽快前往取餐点取餐 ")),m(t,{type:"success",link:"",onClick:i.scrollToReadyOrder},{default:C(()=>[o[11]||(o[11]=F(" 查看订单 ")),m(e,null,{default:C(()=>[m(a)]),_:1})]),_:1},8,["onClick"])])]),_:1})])):K("",!0),m(G,{modelValue:i.activeTab,"onUpdate:modelValue":o[2]||(o[2]=p=>i.activeTab=p),class:"custom-tabs"},{default:C(()=>[m(k,{label:"进行中",name:"ongoing"},{default:C(()=>[f("div",Ve,[m(h,{modelValue:i.orderFilter,"onUpdate:modelValue":o[0]||(o[0]=p=>i.orderFilter=p),size:"small"},{default:C(()=>[m(l,{value:"all"},{default:C(()=>o[13]||(o[13]=[F("全部")])),_:1}),m(l,{value:"ordered"},{default:C(()=>o[14]||(o[14]=[F("已结单")])),_:1}),m(l,{value:"preparing"},{default:C(()=>o[15]||(o[15]=[F("制作中")])),_:1}),m(l,{value:"ready"},{default:C(()=>o[16]||(o[16]=[F("待取餐")])),_:1})]),_:1},8,["modelValue"]),m(y,{modelValue:i.searchKeyword,"onUpdate:modelValue":o[1]||(o[1]=p=>i.searchKeyword=p),placeholder:"搜索订单...","prefix-icon":"Search",clearable:"",class:"search-input"},null,8,["modelValue"])]),i.filteredOngoingOrders.length===0?(O(),W(M,{key:0,description:"暂无进行中的订单","image-size":120},{image:C(()=>[m(e,{class:"empty-icon"},{default:C(()=>[m(S)]),_:1})]),description:C(()=>[o[18]||(o[18]=f("p",{class:"empty-text"},"暂无进行中的订单",-1)),m(t,{type:"primary",onClick:i.goToHome},{default:C(()=>o[17]||(o[17]=[F("去点餐")])),_:1},8,["onClick"])]),_:1})):K("",!0),f("div",xe,[(O(!0),x(Z,null,j(i.filteredOngoingOrders,p=>(O(),W(L,{key:p.id,class:oe(["order-card",{"ready-status":p.status==="ready"}]),ref_for:!0,ref:p.status==="ready"?"readyOrder":null},{default:C(()=>[f("div",{class:oe(["status-badge",p.status])},z(i.getStatusText(p.status)),3),f("div",He,[f("div",Ge,[m(e,null,{default:C(()=>[m(R)]),_:1}),f("span",Ke,z(p.windowName),1)]),f("span",Ye,z(p.createTime),1)]),f("div",We,[f("div",Xe,[(O(!0),x(Z,null,j(p.dishes,c=>(O(),x("div",{class:"dish-item",key:c.id},[f("div",Je,[f("img",{src:c.image_url,alt:c.name},null,8,Ze)]),f("div",je,[f("div",$e,[f("div",et,[f("span",tt,z(c.name),1)]),f("div",rt,[f("span",nt,"x"+z(c.quantity),1),f("span",at,"¥"+z(c.price.toFixed(2)),1)])])])]))),128))]),p.status!=="cancelled"?(O(),x("div",ot,[m(E,{active:i.getProgressStep(p.status),"finish-status":"success"},{default:C(()=>[m(P,{title:"已接单"}),m(P,{title:"制作中"}),m(P,{title:"待取餐"})]),_:2},1032,["active"])])):K("",!0),f("div",it,[f("div",st,[o[19]||(o[19]=f("span",{class:"total-label"},"合计",-1)),f("span",lt,"¥"+z(p.totalPrice.toFixed(2)),1)]),f("div",dt,[p.status==="ordered"?(O(),W(w,{key:0,title:"确定要取消订单吗？","confirm-button-text":"确定","cancel-button-text":"再想想",onConfirm:c=>i.cancelOrder(p)},{reference:C(()=>[m(t,{type:"danger",plain:"",size:"small"},{default:C(()=>o[20]||(o[20]=[F(" 取消订单 ")])),_:1})]),_:2},1032,["onConfirm"])):K("",!0)])])]),p.status==="preparing"?(O(),x("div",ct,[m(e,null,{default:C(()=>[m(N)]),_:1}),F(" 预计等待时间："+z(p.estimatedTime||"15")+"分钟 ",1)])):K("",!0),p.status==="ready"?(O(),x("div",ut,[f("div",ft,[m(e,null,{default:C(()=>[m(A)]),_:1}),o[21]||(o[21]=f("span",null,"您的餐品已准备就绪",-1))]),f("div",ht," 取餐点："+z(p.pickupLocation||"一楼取餐处"),1),m(t,{type:"success",class:"show-qr-btn",onClick:c=>i.showQRCode(p)},{default:C(()=>[m(e,null,{default:C(()=>[m(T)]),_:1}),o[22]||(o[22]=F(" 显示取餐码 "))]),_:2},1032,["onClick"]),o[23]||(o[23]=f("div",{class:"pickup-tips"},[f("p",null,"请在15分钟内完成取餐"),f("p",null,"为保证餐品品质，请尽快取餐")],-1))])):K("",!0)]),_:2},1032,["class"]))),128))])]),_:1}),m(k,{label:"已完成",name:"completed"},{default:C(()=>[i.completedOrders.length===0?(O(),W(M,{key:0,description:"暂无已完成订单"})):K("",!0),(O(!0),x(Z,null,j(i.completedOrders,p=>(O(),W(L,{key:p.id,class:"order-card"}))),128))]),_:1})]),_:1},8,["modelValue"]),m(I,{modelValue:i.qrDialogVisible,"onUpdate:modelValue":o[3]||(o[3]=p=>i.qrDialogVisible=p),title:"取餐码",width:"360px",center:"",class:"qr-dialog","show-close":!0,"close-on-click-modal":!1},{default:C(()=>{var p,c;return[f("div",vt,[f("div",mt,[i.currentOrder?(O(),W(U,{key:0,value:i.generateQRValue(i.currentOrder),size:200,level:"H",class:"pickup-qr","render-as":"svg"},null,8,["value"])):K("",!0)]),f("div",gt,[f("div",pt,z((p=i.currentOrder)==null?void 0:p.windowName),1),f("div",_t,z((c=i.currentOrder)==null?void 0:c.pickupLocation),1)]),f("div",wt,[m(e,null,{default:C(()=>[m(T)]),_:1}),o[24]||(o[24]=f("span",null,"请到取餐处出示此码",-1))])])]}),_:1},8,["modelValue"]),i.isDevelopment?(O(),x("div",Ct,[m(t,{type:"warning",circle:"",onClick:i.testFeatures,class:"float-button test-float-button"},{default:C(()=>[m(e,null,{default:C(()=>[m(D)]),_:1})]),_:1},8,["onClick"])])):K("",!0)])}const Mt=ue(ke,[["render",yt],["__scopeId","data-v-c7730794"]]);export{Mt as default};
