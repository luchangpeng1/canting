import{_ as we,M as be,a$ as ye,b5 as Ce,b as ke,b6 as xe,aB as Ve,u as Se,aV as Fe,b7 as We,W as Le,X as Pe,b8 as Ue,b9 as Ae,g as c,h as Be,ay as me,o as De,j as ze,Y as Te,k as b,n as i,q as e,w as l,v as g,A as Me,$ as pe,z as S,J as re,a0 as He,E as P,af as Ee,Z as $,x as s,aK as Ie,y as f,B as u,aC as ce,I as U,a1 as I}from"./index-CjeFGtzt.js";import{i as ee}from"./index-CUeaqhHS.js";import{u as ue,a as Oe}from"./xlsx-B4zCxbTf.js";const qe={name:"WindowManagement",components:{Plus:be,Upload:ye,UploadFilled:Ce,Shop:ke,Histogram:xe,Money:Ve,User:Se,ArrowDown:Fe,Grid:We,CircleCheck:Le,CircleClose:Pe,Hide:Ue,View:Ae},setup(){const F=c(!1),t=c(!1),te=c(!1),n=c(!1),le=c(null),D=c(""),z=c(""),r=Be({name:"",canteen_id:"",floor:1,type:"",lunch_time:[],dinner_time:[],description:"",status:"open"}),h={name:[{required:!0,message:"请输入窗口名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],canteen_id:[{required:!0,message:"请选择所属餐厅",trigger:"change"}],type:[{required:!0,message:"请选择窗口类型",trigger:"change"}],lunch_time:[{required:!0,message:"请设置午餐时间",trigger:"change"}],dinner_time:[{required:!0,message:"请设置晚餐时间",trigger:"change"}]},ae=o=>({大荤窗口:"danger",小炒窗口:"warning",面食窗口:"success",特色窗口:"primary","清真���口":"info",饮品窗口:"info"})[o]||"info",ne=c([{title:"总窗口数",value:45,type:"primary",icon:"Shop"},{title:"营业中",value:32,type:"success",icon:"Histogram"},{title:"今日营业额",value:"¥28,930",type:"warning",icon:"Money"},{title:"今日客流",value:"3,241",type:"info",icon:"User"}]),O=c(null),W=c(null),q=c(null),R=c(null),N=c("week"),G=c("");let p=[];const y=()=>{const o=ee(O.value);p.push(o);const d={tooltip:{trigger:"axis",formatter:function(m){const _=m[0].value;return`${m[0].name}<br/>${m[0].seriesName}: ¥${_.toLocaleString()}`}},grid:{left:"3%",right:"4%",bottom:"10%",top:"10%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:["周一","周二","周三","周四","周五","周六","周日"],axisLabel:{interval:0,rotate:30,fontSize:12}},yAxis:{type:"value",axisLabel:{formatter:m=>`¥${m.toLocaleString()}`}},series:[{name:"营业额",type:"line",smooth:!0,data:[12e3,13200,15100,14300,19200,21500,23200],areaStyle:{opacity:.1},lineStyle:{width:3},markPoint:{data:[{type:"max",name:"最高值"},{type:"min",name:"最低值"}]},markLine:{data:[{type:"average",name:"平均值"}]}}]};o.setOption(d)};me(N,()=>{$(()=>{y()})});const j=()=>{const o=ee(W.value);p.push(o);const d={tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left",top:"middle",fontSize:12},series:[{name:"窗口类型",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:`{b}
{d}%`,fontSize:12},emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold"}},data:[{name:"大荤窗口",value:15,percentage:33.3},{name:"小炒窗口",value:10,percentage:22.2},{name:"面食窗口",value:10,percentage:22.2},{name:"特色窗口",value:5,percentage:11.1},{name:"清真窗口",value:5,percentage:11.1},{name:"饮品窗口",value:5,percentage:11.1}]}]};o.setOption(d)},J=()=>{const o=ee(q.value);p.push(o);const d={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["营业中","已打烊"],top:"2%"},grid:{left:"20%",right:"5%",bottom:"8%",top:"15%",containLabel:!0},xAxis:{type:"value",axisLabel:{fontSize:12}},yAxis:{type:"category",data:["中央食堂","沁园餐厅","馨园餐厅","仲园餐厅","雅园餐厅","A区服务点","F区服务点"],axisLabel:{fontSize:12,interval:0,margin:16,width:80,overflow:"break"}},series:[{name:"营业中",type:"bar",stack:"total",label:{show:!0,position:"inside",fontSize:12},emphasis:{focus:"series"},data:[10,20,30,20,15,10,5],itemStyle:{color:"#67C23A"}},{name:"已打烊",type:"bar",stack:"total",label:{show:!0,position:"inside",fontSize:12},emphasis:{focus:"series"},data:[5,10,10,10,5,5,5],itemStyle:{color:"#F56C6C"}}]};o.setOption(d)},v=()=>{const o=ee(R.value);p.push(o);const d={tooltip:{trigger:"axis",formatter:function(m){return`${m[0].name}<br/>${m[0].seriesName}: ${m[0].value}人`}},grid:{left:"3%",right:"4%",bottom:"15%",top:"10%",containLabel:!0},xAxis:{type:"category",data:["7:00","8:00","9:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00"],axisLabel:{interval:0,rotate:45,fontSize:12,margin:15}},yAxis:{type:"value",name:"客流量",axisLabel:{formatter:"{value}人"}},series:[{name:"客流量",type:"line",smooth:!0,data:[30,80,120,160,450,650,420,160,100,150,380,520,320,80],markArea:{data:[[{xAxis:"11:00",itemStyle:{color:"rgba(255, 173, 177, 0.2)"}},{xAxis:"13:00"}],[{xAxis:"17:00",itemStyle:{color:"rgba(255, 173, 177, 0.2)"}},{xAxis:"19:00"}]],label:{show:!0,formatter:"用餐高峰"}},markPoint:{data:[{type:"max",name:"最高值"},{type:"min",name:"最低值"}]}}]};o.setOption(d)};me(G,()=>{$(()=>{v()})});const K=()=>{p.forEach(o=>o.resize())};De(()=>{y(),j(),J(),v(),window.addEventListener("resize",K)}),ze(()=>{window.removeEventListener("resize",K),p.forEach(o=>o.dispose())});const oe=c(window.innerWidth<=768),A=c([]),C=c(!1),x=c(""),B=c(""),L=c(!1),T=c(null),X=o=>{A.value=o},k=o=>{switch(T.value=o,o){case"status-open":M("批量设置营业状态","确定将选中的窗口设置为营业中吗？");break;case"status-closed":M("批量设置营业状态","确定将选中的窗口设为已打烊吗？");break;case"delete":M("批量删除窗口","确定要删除选中的窗口？此操作不可恢复！");break;case"export":se();break}},M=(o,d)=>{x.value=o,B.value=d,C.value=!0},Y=async()=>{try{L.value=!0;const o=A.value.map(d=>d.id);switch(T.value){case"status-open":case"status-closed":await ie(o,T.value==="status-open"?"open":"closed");break;case"delete":await H(o);break}P.success("批量操作成功"),C.value=!1,await fetchWindows()}catch(o){P.error("批量作失败："+o.message)}finally{L.value=!1}},ie=async(o,d)=>{await request.post("/admin/windows/batch-status",{ids:o,status:d})},H=async o=>{await request.post("/admin/windows/batch-delete",{ids:o})},se=()=>{const o=A.value.map(_=>({名称:_.name,餐厅:_.canteen,楼层:_.floor+"层",类型:_.type,午餐时间:_.lunch_time,晚餐时间:_.dinner_time,状态:_.status==="open"?"营业中":"已打烊"})),d=ue.json_to_sheet(o),m=ue.book_new();ue.book_append_sheet(m,d,"窗口数据"),Oe(m,"窗口数据.xlsx"),P.success("导出成功")},E=c([{id:0,name:"全部窗口"},{id:1,name:"中央食堂"},{id:2,name:"沁园餐厅"},{id:3,name:"馨园餐厅"},{id:4,name:"仲园餐厅"},{id:5,name:"雅园餐厅"},{id:6,name:"A区服务点"},{id:7,name:"F区服务点"}]),w=c([{id:1,name:"川湘风味",canteen:"中央食堂",floor:1,type:"大荤窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:30",status:"open",description:"提供各类川菜湘菜",isProtected:!1},{id:2,name:"粤式炒饭",canteen:"中央食堂",floor:1,type:"小炒窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:30",status:"open",description:"各类炒饭炒面",isProtected:!1},{id:3,name:"面点王",canteen:"中央食堂",floor:1,type:"面食窗口",lunch_time:"10:00-14:00",dinner_time:"16:00-20:00",status:"open",description:"各类面食",isProtected:!1},{id:4,name:"东北菜",canteen:"沁园餐厅",floor:1,type:"大荤窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:30",status:"open",description:"正宗东北菜",isProtected:!1},{id:5,name:"快餐部",canteen:"沁园餐厅",floor:1,type:"小炒窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:30",status:"closed",description:"快餐套餐",isProtected:!1},{id:6,name:"奶茶店",canteen:"沁园餐厅",floor:1,type:"饮品窗口",lunch_time:"09:30-20:00",dinner_time:"09:30-20:00",status:"open",description:"各类饮品",isProtected:!1},{id:7,name:"兰州拉面",canteen:"馨园餐厅",floor:1,type:"面食窗口",lunch_time:"10:00-14:00",dinner_time:"16:00-20:00",status:"closed",description:"正宗兰州拉面",isProtected:!0},{id:8,name:"特色小炒",canteen:"馨园餐厅",floor:1,type:"小炒窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:30",status:"open",description:"各类特色小炒",isProtected:!1},{id:9,name:"水饺馆",canteen:"馨园餐厅",floor:1,type:"面食窗口",lunch_time:"10:00-14:00",dinner_time:"16:00-20:00",status:"open",description:"各类饺子",isProtected:!1},{id:10,name:"清真餐厅",canteen:"仲园餐厅",floor:1,type:"清真窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:30",status:"open",description:"提供清真美食",isProtected:!1},{id:11,name:"盖浇饭",canteen:"仲园餐厅",floor:1,type:"大荤窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:30",status:"open",description:"各类盖浇饭",isProtected:!1},{id:12,name:"水吧",canteen:"仲园餐厅",floor:1,type:"饮品窗口",lunch_time:"09:30-20:00",dinner_time:"09:30-20:00",status:"open",description:"饮品果汁",isProtected:!1},{id:13,name:"特色小吃",canteen:"雅园餐厅",floor:1,type:"特色窗口",lunch_time:"09:30-19:30",dinner_time:"16:30-19:30",status:"open",description:"各地特色小吃",isProtected:!1},{id:14,name:"火锅窗口",canteen:"雅园餐厅",floor:1,type:"特色窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:30",status:"open",description:"麻辣香锅",isProtected:!1},{id:15,name:"早餐店",canteen:"雅园餐厅",floor:1,type:"面食窗口",lunch_time:"07:00-10:00",dinner_time:"07:00-10:00",status:"closed",description:"各类早点",isProtected:!1},{id:16,name:"简餐套餐",canteen:"A区服务点",floor:1,type:"小炒窗口",lunch_time:"11:00-13:30",dinner_time:"17:00-19:00",status:"open",description:"提供经济实惠的套餐",isProtected:!1},{id:17,name:"A区饮品店",canteen:"A区服务点",floor:1,type:"饮品窗口",lunch_time:"08:00-20:00",dinner_time:"08:00-20:00",status:"open",description:"奶茶咖啡汁",isProtected:!1},{id:18,name:"面食快餐",canteen:"A区服务点",floor:1,type:"面食窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:00",status:"closed",description:"各面食快餐",isProtected:!1},{id:19,name:"盖浇快餐",canteen:"F区服务点",floor:1,type:"大荤窗口",lunch_time:"10:30-13:30",dinner_time:"16:30-19:00",status:"open",description:"各类盖浇饭",isProtected:!1},{id:20,name:"特色小吃",canteen:"F区服务点",floor:1,type:"特色窗口",lunch_time:"09:30-19:30",dinner_time:"09:30-19:30",status:"open",description:"各类特色小吃",isProtected:!1},{id:21,name:"F区饮品",canteen:"F区服务点",floor:1,type:"饮品窗口",lunch_time:"08:00-20:00",dinner_time:"08:00-20:00",status:"open",description:"饮品果汁",isProtected:!1}]),de=Te(()=>w.value.filter(o=>{var _;const d=!D.value||D.value===0||o.canteen===((_=E.value.find(ve=>ve.id===D.value))==null?void 0:_.name),m=!z.value||o.status===z.value;return d&&m})),a=()=>{n.value=!1,r.name="",r.canteen_id="",r.floor=1,r.type="",r.lunch_time=[],r.dinner_time=[],r.description="",t.value=!0},V=o=>{n.value=!0,Object.assign(r,o),t.value=!0},fe=o=>{Ee.confirm("确定要删除该窗口吗？此操作不可恢复！","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const d=w.value.findIndex(m=>m.id===o.id);w.value.splice(d,1),P.success("删除成功")}).catch(()=>{})},_e=(o,d)=>{o.statusLoading=!0,setTimeout(()=>{o.status=d,o.statusLoading=!1,P.success(`状态已更新为${d==="open"?"营业中":"已打烊"}`)},500)},ge=()=>{le.value.validate(o=>{o&&(F.value=!0,setTimeout(()=>{var d;if(n.value){const m=w.value.findIndex(_=>_.id===r.id);w.value[m]={...r},P.success("修改成功")}else{const m={id:w.value.length+1,...r,canteen:(d=E.value.find(_=>_.id===r.canteen_id))==null?void 0:d.name};w.value.push(m),P.success("添加成功")}t.value=!1,F.value=!1},500))})},Z=c(!0),he=()=>{Z.value=!Z.value,Z.value&&$(()=>{y(),j(),J(),v()})},Q=c(!0);return{loading:F,dialogVisible:t,importDialogVisible:te,isEdit:n,windowFormRef:le,windowForm:r,canteenFilter:D,statusFilter:z,rules:h,getTypeTag:ae,statistics:ne,revenueChart:O,typeChart:W,canteenChart:q,peakHoursChart:R,revenueTimeRange:N,peakCanteen:G,isMobile:oe,selectedWindows:A,batchDialogVisible:C,batchDialogTitle:x,batchDialogMessage:B,batchLoading:L,handleSelectionChange:X,handleBatchCommand:k,confirmBatchOperation:Y,canteens:E,windows:w,filteredWindows:de,showAddDialog:a,editWindow:V,deleteWindow:fe,handleStatusChange:_e,saveWindow:ge,showStatistics:Z,toggleStatistics:he,showWindowList:Q,toggleWindowList:()=>{Q.value=!Q.value,Q.value&&$(()=>{})},handleBatchImport:()=>{te.value=!0}}}},Re={class:"toolbar",style:{"margin-bottom":"20px"}},Ne={class:"left"},Ge={key:0,class:"batch-actions"},je={class:"selected-count"},Je={class:"right"},Ke={class:"operation-time"},Xe={class:"statistics-section"},Ye={class:"stat-content"},Ze={class:"stat-value"},Qe={class:"stat-title"},$e={class:"stat-sub-title"},et={class:"chart-header"},tt={ref:"revenueChart",class:"chart"},lt={ref:"typeChart",class:"chart"},at={ref:"canteenChart",class:"chart"},nt={class:"chart-header"},ot={ref:"peakHoursChart",class:"chart"},it={class:"batch-dialog-content"},st={class:"selected-items"};function dt(F,t,te,n,le,D){const z=s("Plus"),r=s("el-icon"),h=s("el-button"),ae=s("Upload"),ne=s("el-divider"),O=s("arrow-down"),W=s("el-dropdown-item"),q=s("el-dropdown-menu"),R=s("el-dropdown"),N=s("Grid"),G=s("Shop"),p=s("el-option"),y=s("el-select"),j=s("CircleCheck"),J=s("CircleClose"),v=s("el-table-column"),K=s("el-tag"),oe=s("el-switch"),A=s("el-table"),C=s("el-card"),x=s("el-col"),B=s("el-row"),L=s("el-radio-button"),T=s("el-radio-group"),X=s("el-input"),k=s("el-form-item"),M=s("el-input-number"),Y=s("el-time-picker"),ie=s("el-form"),H=s("el-dialog"),se=s("upload-filled"),E=s("el-upload"),w=s("el-scrollbar"),de=Ie("loading");return f(),b("div",{class:re(["window-management",{mobile:n.isMobile}])},[i("div",Re,[i("div",Ne,[e(h,{type:"primary",onClick:n.showAddDialog},{default:l(()=>[e(r,null,{default:l(()=>[e(z)]),_:1}),t[16]||(t[16]=u("添加窗口 "))]),_:1},8,["onClick"]),e(h,{type:"success",onClick:n.handleBatchImport},{default:l(()=>[e(r,null,{default:l(()=>[e(ae)]),_:1}),t[17]||(t[17]=u("批量导入 "))]),_:1},8,["onClick"]),e(h,{type:n.showStatistics?"info":"default",onClick:n.toggleStatistics},{default:l(()=>[e(r,null,{default:l(()=>[(f(),S(ce(n.showStatistics?"Hide":"View")))]),_:1}),u(" "+g(n.showStatistics?"隐藏统计":"显示统计"),1)]),_:1},8,["type","onClick"]),e(h,{type:n.showWindowList?"info":"default",onClick:n.toggleWindowList},{default:l(()=>[e(r,null,{default:l(()=>[(f(),S(ce(n.showWindowList?"Hide":"View")))]),_:1}),u(" "+g(n.showWindowList?"隐藏列表":"显示列表"),1)]),_:1},8,["type","onClick"]),n.selectedWindows.length>0?(f(),b("div",Ge,[e(ne,{direction:"vertical"}),e(R,{onCommand:n.handleBatchCommand},{dropdown:l(()=>[e(q,null,{default:l(()=>[e(W,{command:"status-open"},{default:l(()=>t[19]||(t[19]=[u("设为营业中")])),_:1}),e(W,{command:"status-closed"},{default:l(()=>t[20]||(t[20]=[u("设为已打烊")])),_:1}),e(W,{command:"export"},{default:l(()=>t[21]||(t[21]=[u("导出数据")])),_:1}),e(W,{command:"delete",divided:""},{default:l(()=>t[22]||(t[22]=[i("span",{style:{color:"#f56c6c"}},"批量删除",-1)])),_:1})]),_:1})]),default:l(()=>[e(h,{type:"primary"},{default:l(()=>[t[18]||(t[18]=u(" 批量操作")),e(r,{class:"el-icon--right"},{default:l(()=>[e(O)]),_:1})]),_:1})]),_:1},8,["onCommand"]),i("span",je,"已选择 "+g(n.selectedWindows.length)+" 项",1)])):Me("",!0)]),i("div",Je,[e(y,{modelValue:n.canteenFilter,"onUpdate:modelValue":t[0]||(t[0]=a=>n.canteenFilter=a),placeholder:"选择餐厅",class:"filter-select","popper-class":"canteen-select-dropdown",style:{width:"160px"}},{default:l(()=>[(f(!0),b(U,null,I(n.canteens,a=>(f(),S(p,{key:a.id,label:a.name,value:a.id},{default:l(()=>[a.id===0?(f(),b(U,{key:0},[e(r,null,{default:l(()=>[e(N)]),_:1}),i("span",null,g(a.name),1)],64)):(f(),b(U,{key:1},[e(r,null,{default:l(()=>[e(G)]),_:1}),i("span",null,g(a.name),1)],64))]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),e(y,{modelValue:n.statusFilter,"onUpdate:modelValue":t[1]||(t[1]=a=>n.statusFilter=a),placeholder:"营业状态",class:"filter-select","popper-class":"status-select-dropdown",style:{width:"120px"}},{default:l(()=>[e(p,{label:"营业中",value:"open"},{default:l(()=>[e(r,{color:"#67C23A"},{default:l(()=>[e(j)]),_:1}),t[23]||(t[23]=i("span",null,"营业中",-1))]),_:1}),e(p,{label:"已打烊",value:"closed"},{default:l(()=>[e(r,{color:"#F56C6C"},{default:l(()=>[e(J)]),_:1}),t[24]||(t[24]=i("span",null,"已打烊",-1))]),_:1})]),_:1},8,["modelValue"])])]),i("div",{class:re(["table-container",{hidden:!n.showWindowList}])},[pe((f(),S(A,{data:n.filteredWindows,style:{width:"100%"},border:"",stripe:"",onSelectionChange:n.handleSelectionChange},{default:l(()=>[e(v,{type:"selection",width:"55",selectable:a=>!a.isProtected},null,8,["selectable"]),e(v,{prop:"name",label:"窗口名称","min-width":"150"}),e(v,{prop:"canteen",label:"所属餐厅",width:"120"}),e(v,{prop:"floor",label:"楼层",width:"80"},{default:l(({row:a})=>[u(g(a.floor)+"层 ",1)]),_:1}),e(v,{prop:"type",label:"窗口类型",width:"120"},{default:l(({row:a})=>[e(K,{type:n.getTypeTag(a.type)},{default:l(()=>[u(g(a.type),1)]),_:2},1032,["type"])]),_:1}),e(v,{label:"营业时间",width:"220"},{default:l(({row:a})=>[i("div",Ke,[i("div",null,"午餐："+g(a.lunch_time),1),i("div",null,"晚餐："+g(a.dinner_time),1)])]),_:1}),e(v,{label:"状态",width:"100"},{default:l(({row:a})=>[e(oe,{modelValue:a.status,"onUpdate:modelValue":V=>a.status=V,"active-value":"open","inactive-value":"closed",onChange:V=>n.handleStatusChange(a,V),loading:a.statusLoading},null,8,["modelValue","onUpdate:modelValue","onChange","loading"])]),_:1}),e(v,{label:"操作",width:"200",fixed:"right"},{default:l(({row:a})=>[e(h,{link:"",type:"primary",onClick:V=>n.editWindow(a)},{default:l(()=>t[25]||(t[25]=[u(" 编辑 ")])),_:2},1032,["onClick"]),e(h,{link:"",type:"success",onClick:V=>F.manageMenu(a)},{default:l(()=>t[26]||(t[26]=[u(" 管理菜单 ")])),_:2},1032,["onClick"]),e(h,{link:"",type:"danger",onClick:V=>n.deleteWindow(a)},{default:l(()=>t[27]||(t[27]=[u(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[de,n.loading]])],2),pe(i("div",Xe,[e(B,{gutter:20,class:"stat-cards"},{default:l(()=>[(f(!0),b(U,null,I(n.statistics,a=>(f(),S(x,{span:6,key:a.title},{default:l(()=>[e(C,{class:re(["stat-card",a.type])},{default:l(()=>[i("div",Ye,[i("div",Ze,g(a.value),1),i("div",Qe,g(a.title),1),i("div",$e,g(a.subTitle),1)]),e(r,{class:"stat-icon"},{default:l(()=>[(f(),S(ce(a.icon)))]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1}),e(B,{gutter:20,class:"chart-row"},{default:l(()=>[e(x,{span:16},{default:l(()=>[e(C,{class:"chart-card"},{header:l(()=>[i("div",et,[t[31]||(t[31]=i("span",null,"营业额趋势",-1)),e(T,{modelValue:n.revenueTimeRange,"onUpdate:modelValue":t[2]||(t[2]=a=>n.revenueTimeRange=a),size:"small"},{default:l(()=>[e(L,{value:"week"},{default:l(()=>t[28]||(t[28]=[u("本周")])),_:1}),e(L,{value:"month"},{default:l(()=>t[29]||(t[29]=[u("本月")])),_:1}),e(L,{value:"year"},{default:l(()=>t[30]||(t[30]=[u("全年")])),_:1})]),_:1},8,["modelValue"])])]),default:l(()=>[i("div",tt,null,512)]),_:1})]),_:1}),e(x,{span:8},{default:l(()=>[e(C,{class:"chart-card"},{header:l(()=>t[32]||(t[32]=[i("div",{class:"chart-header"},[i("span",null,"窗口类型分布")],-1)])),default:l(()=>[i("div",lt,null,512)]),_:1})]),_:1})]),_:1}),e(B,{gutter:20,class:"chart-row"},{default:l(()=>[e(x,{span:12},{default:l(()=>[e(C,{class:"chart-card"},{header:l(()=>t[33]||(t[33]=[i("div",{class:"chart-header"},[i("span",null,"各餐厅窗口数量")],-1)])),default:l(()=>[i("div",at,null,512)]),_:1})]),_:1}),e(x,{span:12},{default:l(()=>[e(C,{class:"chart-card"},{header:l(()=>[i("div",nt,[t[34]||(t[34]=i("span",null,"客流高峰时段",-1)),e(y,{modelValue:n.peakCanteen,"onUpdate:modelValue":t[3]||(t[3]=a=>n.peakCanteen=a),size:"small",placeholder:"选择餐厅"},{default:l(()=>[(f(!0),b(U,null,I(n.canteens,a=>(f(),S(p,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),default:l(()=>[i("div",ot,null,512)]),_:1})]),_:1})]),_:1})],512),[[He,n.showStatistics]]),e(H,{title:n.isEdit?"编辑窗口":"添加窗口",modelValue:n.dialogVisible,"onUpdate:modelValue":t[12]||(t[12]=a=>n.dialogVisible=a),width:"500px"},{footer:l(()=>[e(h,{onClick:t[11]||(t[11]=a=>n.dialogVisible=!1)},{default:l(()=>t[35]||(t[35]=[u("取消")])),_:1}),e(h,{type:"primary",onClick:n.saveWindow,loading:n.loading},{default:l(()=>[u(g(n.isEdit?"保存修改":"添加窗口"),1)]),_:1},8,["onClick","loading"])]),default:l(()=>[e(ie,{model:n.windowForm,rules:n.rules,ref:"windowFormRef","label-width":"100px"},{default:l(()=>[e(k,{label:"窗口名称",prop:"name"},{default:l(()=>[e(X,{modelValue:n.windowForm.name,"onUpdate:modelValue":t[4]||(t[4]=a=>n.windowForm.name=a),placeholder:"请输入窗口名称"},null,8,["modelValue"])]),_:1}),e(k,{label:"所属餐厅",prop:"canteen_id"},{default:l(()=>[e(y,{modelValue:n.windowForm.canteen_id,"onUpdate:modelValue":t[5]||(t[5]=a=>n.windowForm.canteen_id=a),placeholder:"请选择餐厅"},{default:l(()=>[(f(!0),b(U,null,I(n.canteens,a=>(f(),S(p,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"所在楼层",prop:"floor"},{default:l(()=>[e(M,{modelValue:n.windowForm.floor,"onUpdate:modelValue":t[6]||(t[6]=a=>n.windowForm.floor=a),min:1,max:5,"controls-position":"right"},null,8,["modelValue"])]),_:1}),e(k,{label:"窗口类型",prop:"type"},{default:l(()=>[e(y,{modelValue:n.windowForm.type,"onUpdate:modelValue":t[7]||(t[7]=a=>n.windowForm.type=a),placeholder:"请选择类型"},{default:l(()=>[e(p,{label:"大荤窗口",value:"大荤窗口"}),e(p,{label:"小炒窗口",value:"小炒窗口"}),e(p,{label:"面食窗口",value:"面食窗口"}),e(p,{label:"特色窗口",value:"特色窗口"}),e(p,{label:"清真窗口",value:"清真窗口"}),e(p,{label:"饮品窗口",value:"饮品窗口"})]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"午餐时间",prop:"lunch_time"},{default:l(()=>[e(Y,{modelValue:n.windowForm.lunch_time,"onUpdate:modelValue":t[8]||(t[8]=a=>n.windowForm.lunch_time=a),"is-range":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"HH:mm"},null,8,["modelValue"])]),_:1}),e(k,{label:"晚餐时间",prop:"dinner_time"},{default:l(()=>[e(Y,{modelValue:n.windowForm.dinner_time,"onUpdate:modelValue":t[9]||(t[9]=a=>n.windowForm.dinner_time=a),"is-range":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"HH:mm"},null,8,["modelValue"])]),_:1}),e(k,{label:"窗口描述",prop:"description"},{default:l(()=>[e(X,{modelValue:n.windowForm.description,"onUpdate:modelValue":t[10]||(t[10]=a=>n.windowForm.description=a),type:"textarea",rows:3,placeholder:"请输入窗口描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(H,{title:"批量导入窗口",modelValue:n.importDialogVisible,"onUpdate:modelValue":t[13]||(t[13]=a=>n.importDialogVisible=a),width:"400px"},{default:l(()=>[e(E,{class:"upload-demo",drag:"",action:"/api/admin/windows/import",accept:".xlsx,.xls","on-success":F.handleImportSuccess,"before-upload":F.beforeImportUpload},{tip:l(()=>t[36]||(t[36]=[i("div",{class:"el-upload__tip"}," 只能上传 xlsx/xls 文件，且文件大小不超过 2MB ",-1)])),default:l(()=>[e(r,{class:"el-icon--upload"},{default:l(()=>[e(se)]),_:1}),t[37]||(t[37]=i("div",{class:"el-upload__text"},[u(" 将文件拖到此处，或"),i("em",null,"点击上传")],-1))]),_:1},8,["on-success","before-upload"])]),_:1},8,["modelValue"]),e(H,{modelValue:n.batchDialogVisible,"onUpdate:modelValue":t[15]||(t[15]=a=>n.batchDialogVisible=a),title:n.batchDialogTitle,width:"400px"},{footer:l(()=>[e(h,{onClick:t[14]||(t[14]=a=>n.batchDialogVisible=!1)},{default:l(()=>t[38]||(t[38]=[u("取消")])),_:1}),e(h,{type:"primary",loading:n.batchLoading,onClick:n.confirmBatchOperation},{default:l(()=>t[39]||(t[39]=[u(" 确定 ")])),_:1},8,["loading","onClick"])]),default:l(()=>[i("div",it,[i("p",null,g(n.batchDialogMessage),1),i("div",st,[e(w,{"max-height":"200px"},{default:l(()=>[i("ul",null,[(f(!0),b(U,null,I(n.selectedWindows,a=>(f(),b("li",{key:a.id},g(a.name),1))),128))])]),_:1})])])]),_:1},8,["modelValue","title"])],2)}const ft=we(qe,[["render",dt],["__scopeId","data-v-bafe6a3d"]]);export{ft as default};
