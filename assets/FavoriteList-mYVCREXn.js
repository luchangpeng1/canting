import{_ as R,R as U,al as j,am as q,P as G,S as P,l as I,a3 as X,an as Y,g as h,V as B,o as J,k as g,q as a,n as l,w as s,z as S,ao as K,E as W,x as i,y as c,H as V,X as x,B as k,v as d,ap as Z,A as $}from"./index-1A1V_OG6.js";import{B as ee}from"./BackHeader-CptAMduT.js";function te(r){if(!r)return"";const o=new Date(r);if(isNaN(o.getTime()))return"";const u=new Date,t=u-o,f=24*60*60*1e3,v=7*f;if(o.toDateString()===u.toDateString()){const _=o.getHours().toString().padStart(2,"0"),p=o.getMinutes().toString().padStart(2,"0");return`今天 ${_}:${p}`}const b=new Date(u-f);if(o.toDateString()===b.toDateString()){const _=o.getHours().toString().padStart(2,"0"),p=o.getMinutes().toString().padStart(2,"0");return`昨天 ${_}:${p}`}if(t<v)return["周日","周一","周二","周三","周四","周五","周六"][o.getDay()];const C=o.getFullYear(),y=(o.getMonth()+1).toString().padStart(2,"0"),w=o.getDate().toString().padStart(2,"0");return`${C}-${y}-${w}`}const ne={name:"FavoriteList",components:{Picture:U,BackHeader:ee,Loading:j,Star:q,Timer:G,Search:P,Location:I,Calendar:X,Sell:Y},setup(){const r=h([]),o=h(!0),u=h(null),t=h(""),f=h(""),v=h(""),b=[{id:1,name:"红烧肉",price:15,image_url:"https://example.com/hongshaorou.jpg",canteen:"第一食堂",window:"大众餐窗口",rating:4.5,waitTime:10,tags:["热销","招牌菜","肉类"],collectedAt:"2024-03-15 12:30"},{id:2,name:"清炒时蔬",price:8,image_url:"https://example.com/qingcao.jpg",canteen:"第二食堂",window:"素食窗口",rating:4.2,waitTime:5,tags:["素菜","健康"],collectedAt:"2024-03-14 18:20"}],C=B(()=>[...new Set(r.value.map(n=>n.canteen))]),y=B(()=>[...new Set(r.value.map(n=>n.window))]),w=B(()=>r.value.filter(n=>{const m=!t.value||n.name.toLowerCase().includes(t.value.toLowerCase()),T=!f.value||n.canteen===f.value,F=!v.value||n.window===v.value;return m&&T&&F})),_=async n=>{try{u.value=n,await new Promise(m=>setTimeout(m,500)),r.value=r.value.filter(m=>m.id!==n),W.success("已取消收藏")}catch{W.error("操作失败")}finally{u.value=null}},p=n=>n>=4.5?"#ff6b6b":n>=4?"#ff922b":n>=3.5?"#51cf66":"#868e96",L=n=>{console.log("查看详情:",n)};return J(async()=>{try{await new Promise(n=>setTimeout(n,800)),r.value=b}finally{o.value=!1}}),{favorites:r,loading:o,removing:u,searchQuery:t,selectedCanteen:f,selectedWindow:v,canteenOptions:C,windowOptions:y,filteredFavorites:w,removeFavorite:_,getRatingColor:p,viewDishDetail:L,formatDate:te,Search:P}}},ae={class:"favorite-list"},oe={class:"filter-section"},le={class:"filter-buttons"},se={key:0,class:"loading-wrapper"},ie={class:"dish-content"},ce={class:"dish-image"},re={class:"image-placeholder"},de={class:"image-placeholder"},ue={class:"collect-time"},_e={class:"dish-info"},me={class:"dish-header"},fe={class:"price"},pe={class:"location-info"},ge={class:"dish-stats"},ve={class:"stat-item"},ye={class:"stat-item"},we={key:0,class:"tags-container"},he={class:"actions"};function Se(r,o,u,t,f,v){const b=i("back-header"),C=i("el-input"),y=i("el-option"),w=i("el-select"),_=i("el-skeleton"),p=i("el-empty"),L=i("Loading"),n=i("el-icon"),m=i("Picture"),T=i("el-image"),F=i("Calendar"),M=i("Location"),z=i("el-tag"),Q=i("Star"),A=i("Timer"),H=i("Sell"),N=i("el-button"),O=i("el-popconfirm"),E=i("el-card");return c(),g("div",ae,[a(b,{title:"我的收藏"}),l("div",oe,[a(C,{modelValue:t.searchQuery,"onUpdate:modelValue":o[0]||(o[0]=e=>t.searchQuery=e),placeholder:"搜索菜品名称",class:"search-input",clearable:"","prefix-icon":t.Search},null,8,["modelValue","prefix-icon"]),l("div",le,[a(w,{modelValue:t.selectedCanteen,"onUpdate:modelValue":o[1]||(o[1]=e=>t.selectedCanteen=e),placeholder:"选择餐厅",clearable:"",class:"filter-select"},{default:s(()=>[(c(!0),g(V,null,x(t.canteenOptions,e=>(c(),S(y,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(w,{modelValue:t.selectedWindow,"onUpdate:modelValue":o[2]||(o[2]=e=>t.selectedWindow=e),placeholder:"选择窗口",clearable:"",class:"filter-select"},{default:s(()=>[(c(!0),g(V,null,x(t.windowOptions,e=>(c(),S(y,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),t.loading?(c(),g("div",se,[a(_,{rows:3,animated:""})])):t.filteredFavorites.length===0?(c(),S(p,{key:1,description:t.searchQuery||t.selectedCanteen||t.selectedWindow?"没有找到符合条件的菜品":"暂无收藏的菜品","image-size":180},null,8,["description"])):(c(),S(K,{key:2,name:"list",tag:"div",class:"favorites-container"},{default:s(()=>[(c(!0),g(V,null,x(t.filteredFavorites,e=>(c(),S(E,{key:e.id,class:"dish-card","body-style":{padding:"0px"},shadow:"hover"},{default:s(()=>[l("div",ie,[l("div",ce,[a(T,{src:e.image_url,fit:"cover",loading:"lazy","preview-src-list":[e.image_url]},{placeholder:s(()=>[l("div",re,[a(n,{class:"is-loading"},{default:s(()=>[a(L)]),_:1})])]),error:s(()=>[l("div",de,[a(n,null,{default:s(()=>[a(m)]),_:1})])]),_:2},1032,["src","preview-src-list"]),l("div",ue,[a(n,null,{default:s(()=>[a(F)]),_:1}),k(" "+d(t.formatDate(e.collectedAt)),1)])]),l("div",_e,[l("div",me,[l("h3",null,d(e.name),1),l("div",fe,"¥"+d(e.price),1)]),l("div",pe,[a(z,{size:"small",type:"success",effect:"dark"},{default:s(()=>[a(n,null,{default:s(()=>[a(M)]),_:1}),k(" "+d(e.canteen),1)]),_:2},1024),a(z,{size:"small",type:"warning"},{default:s(()=>[k(d(e.window),1)]),_:2},1024)]),l("div",ge,[l("div",{class:"stat-item",style:Z({color:t.getRatingColor(e.rating)})},[a(n,null,{default:s(()=>[a(Q)]),_:1}),l("span",null,d(e.rating)+"分",1)],4),l("div",ve,[a(n,null,{default:s(()=>[a(A)]),_:1}),l("span",null,"等待"+d(e.waitTime)+"分钟",1)]),l("div",ye,[a(n,null,{default:s(()=>[a(H)]),_:1}),l("span",null,"月售"+d(e.monthlySales||0),1)])]),e.tags&&e.tags.length?(c(),g("div",we,[(c(!0),g(V,null,x(e.tags,D=>(c(),S(z,{key:D,size:"small",effect:"light",class:"dish-tag"},{default:s(()=>[k(d(D),1)]),_:2},1024))),128))])):$("",!0),l("div",he,[a(N,{type:"primary",size:"small",plain:"",onClick:D=>t.viewDishDetail(e.id)},{default:s(()=>o[3]||(o[3]=[k(" 查看详情 ")])),_:2},1032,["onClick"]),a(O,{title:"确定取消收藏该菜品吗？",onConfirm:D=>t.removeFavorite(e.id),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:s(()=>[a(N,{type:"danger",size:"small",plain:"",loading:t.removing===e.id},{default:s(()=>[k(d(t.removing===e.id?"取消中...":"取消收藏"),1)]),_:2},1032,["loading"])]),_:2},1032,["onConfirm"])])])])]),_:2},1024))),128))]),_:1}))])}const Ce=R(ne,[["render",Se],["__scopeId","data-v-6db101fb"]]);export{Ce as default};
