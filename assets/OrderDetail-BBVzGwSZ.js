import{_ as D,a7 as L,g as B,o as N,k as d,n as e,q as r,w as n,af as A,z as C,A as v,E as p,ad as b,x as m,ag as q,y as i,v as a,B as w,H as O,X as S,J as E,C as V}from"./index-eMRJYRn7.js";import"./request-C5bOnPyA.js";const F={name:"OrderDetail",components:{ArrowLeft:L},setup(){const T=E(),s=V(),l=B(!1),t=B({}),x=async()=>{l.value=!0;try{t.value={id:T.params.id,orderNumber:"ORD202403150001",status:"completed",createTime:"2024-03-15 12:30:00",completedTime:"2024-03-15 13:00:00",windowName:"特色炒菜",totalAmount:45,discount:5,mealType:"dine_in",reservedTime:"2024-03-15 12:45:00",paymentMethod:"balance",remark:"不要太辣",dishes:[{id:1,name:"宫保鸡丁",price:15,quantity:2,image_url:"https://example.com/dish1.jpg"},{id:2,name:"麻婆豆腐",price:15,quantity:1,image_url:"https://example.com/dish2.jpg"}]}}catch(o){console.error("获取订单详情失败:",o),p.error("获取订单详情失败")}finally{l.value=!1}},M=o=>({pending:"待处理",processing:"处理中",completed:"已完成",cancelled:"已取消"})[o]||o,f=o=>({pending:"warning",processing:"primary",completed:"success",cancelled:"info"})[o]||"",g=o=>({dine_in:"堂食",take_out:"打包"})[o]||o,_=o=>({balance:"余额支付",wechat:"微信支付",alipay:"支付宝"})[o]||o,y=o=>{s.push(`/student/dishes/${o}`)},u=async()=>{try{await b.confirm("确��要取消这个订单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),p.success("订单已取消"),s.back()}catch(o){o!=="cancel"&&(console.error("取消订单失败:",o),p.error("取消订单失败"))}},h=async()=>{try{await b.confirm("是否将订单中的菜品重新加入购物车？","再来一单",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}),l.value=!0,await new Promise(c=>setTimeout(c,500)),p.success({message:"已将菜品添加到购物车",duration:2e3}),await b.confirm("菜品已添加到购物车，是否立即前往购物车？","提示",{confirmButtonText:"前往购物车",cancelButtonText:"继续浏览",type:"success"}).catch(()=>!1)&&s.push("/student/cart")}catch(o){o!=="cancel"&&(console.error("再来一单失败:",o),p.error("操作失败，请重试"))}finally{l.value=!1}},k=()=>{s.back()};return N(()=>{x()}),{order:t,loading:l,getStatusLabel:M,getStatusType:f,getMealTypeLabel:g,getPaymentMethodLabel:_,viewDishDetail:y,cancelOrder:u,reorder:h,goBack:k}}},P={class:"order-detail"},R={class:"back-button"},j={class:"back-content"},z={class:"detail-content"},H={class:"status-header"},I={class:"order-info"},J={class:"order-number"},X={class:"order-time"},G={class:"time-item"},K={class:"value"},Q={key:0,class:"time-item"},U={class:"value"},W={class:"card-header"},Y={class:"window-name"},Z={class:"dishes-list"},$={class:"dish-info"},ee={class:"dish-name"},se={class:"dish-meta"},te={class:"dish-price"},oe={class:"dish-quantity"},ae={class:"dish-subtotal"},ne={class:"price-summary"},re={class:"price-item"},ie={class:"price-item"},le={class:"discount"},ce={class:"price-item total"},de={class:"final-price"},me={class:"info-list"},_e={class:"info-item"},ue={class:"value"},pe={class:"info-item"},ve={class:"value"},fe={class:"info-item"},ge={class:"value"},ye={key:0,class:"info-item"},he={class:"value"},ke={class:"action-buttons"};function be(T,s,l,t,x,M){const f=m("ArrowLeft"),g=m("el-icon"),_=m("el-button"),y=m("el-tag"),u=m("el-card"),h=m("el-image"),k=q("loading");return i(),d("div",P,[e("div",R,[r(_,{onClick:t.goBack,class:"custom-back-btn",link:""},{default:n(()=>[e("div",j,[r(g,{class:"back-icon"},{default:n(()=>[r(f)]),_:1}),s[0]||(s[0]=e("span",{class:"back-text"},"返回上一页",-1))])]),_:1},8,["onClick"])]),A((i(),d("div",z,[r(u,{class:"status-card"},{default:n(()=>[e("div",H,[e("div",I,[e("h2",J,"订单号："+a(t.order.orderNumber),1),r(y,{type:t.getStatusType(t.order.status),class:"status-tag",size:"large"},{default:n(()=>[w(a(t.getStatusLabel(t.order.status)),1)]),_:1},8,["type"])]),e("div",X,[e("div",G,[s[1]||(s[1]=e("span",{class:"label"},"下单时间：",-1)),e("span",K,a(t.order.createTime),1)]),t.order.completedTime?(i(),d("div",Q,[s[2]||(s[2]=e("span",{class:"label"},"完成时间：",-1)),e("span",U,a(t.order.completedTime),1)])):v("",!0)])])]),_:1}),r(u,{class:"dishes-card"},{header:n(()=>[e("div",W,[s[3]||(s[3]=e("h3",null,"菜品详情",-1)),e("span",Y,a(t.order.windowName),1)])]),default:n(()=>[e("div",Z,[(i(!0),d(O,null,S(t.order.dishes,o=>(i(),d("div",{key:o.id,class:"dish-item"},[r(h,{src:o.image_url,alt:o.name,class:"dish-image",onClick:c=>t.viewDishDetail(o.id)},{error:n(()=>s[4]||(s[4]=[e("div",{class:"image-placeholder"},"暂无图片",-1)])),_:2},1032,["src","alt","onClick"]),e("div",$,[e("h4",ee,a(o.name),1),e("div",se,[e("span",te,"¥"+a(o.price),1),e("span",oe,"× "+a(o.quantity),1)])]),e("div",ae," ¥"+a((o.price*o.quantity).toFixed(2)),1)]))),128))]),e("div",ne,[e("div",re,[s[5]||(s[5]=e("span",null,"商品总额",-1)),e("span",null,"¥"+a(t.order.totalAmount),1)]),e("div",ie,[s[6]||(s[6]=e("span",null,"优惠金额",-1)),e("span",le,"-¥"+a(t.order.discount||0),1)]),e("div",ce,[s[7]||(s[7]=e("span",null,"实付金额",-1)),e("span",de,"¥"+a((t.order.totalAmount-(t.order.discount||0)).toFixed(2)),1)])])]),_:1}),r(u,{class:"order-info-card"},{header:n(()=>s[8]||(s[8]=[e("h3",null,"订单信息",-1)])),default:n(()=>[e("div",me,[e("div",_e,[s[9]||(s[9]=e("span",{class:"label"},"就餐方式：",-1)),e("span",ue,a(t.getMealTypeLabel(t.order.mealType)),1)]),e("div",pe,[s[10]||(s[10]=e("span",{class:"label"},"预定时间：",-1)),e("span",ve,a(t.order.reservedTime),1)]),e("div",fe,[s[11]||(s[11]=e("span",{class:"label"},"支付方式：",-1)),e("span",ge,a(t.getPaymentMethodLabel(t.order.paymentMethod)),1)]),t.order.remark?(i(),d("div",ye,[s[12]||(s[12]=e("span",{class:"label"},"备注：",-1)),e("span",he,a(t.order.remark),1)])):v("",!0)])]),_:1}),e("div",ke,[t.order.status==="pending"?(i(),C(_,{key:0,type:"danger",onClick:t.cancelOrder},{default:n(()=>s[13]||(s[13]=[w(" 取消订单 ")])),_:1},8,["onClick"])):v("",!0),t.order.status==="completed"?(i(),C(_,{key:1,type:"primary",plain:"",onClick:t.reorder},{default:n(()=>s[14]||(s[14]=[w(" 再来一单 ")])),_:1},8,["onClick"])):v("",!0)])])),[[k,t.loading]])])}const xe=D(F,[["render",be],["__scopeId","data-v-833de557"]]);export{xe as default};
