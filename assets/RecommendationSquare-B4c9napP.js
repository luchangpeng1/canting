import{_ as J,a3 as K,a5 as O,a6 as Q,a7 as W,L as X,g as f,o as Y,k as u,q as t,n as a,w as n,H as h,V as w,E as k,x as s,y as r,B as c,z as x,v as d,A as R,I as Z}from"./index-DxkRXB23.js";const $={name:"RecommendationSquare",components:{Edit:K,CaretTop:O,ChatDotRound:Q,Share:W,Plus:X},setup(){const D=f([]),o=f(!1),y=f(!1),l=f(""),V=f({type:"recommend",title:"",canteen:"",window:"",dish:"",content:"",images:[]}),z=[{id:1,user:{name:"张三",avatar:""},type:"recommend",title:"中央食堂的红烧肉太好吃了！",canteen:"中央食堂",window:"特色炒菜",dish:"红烧肉",content:"今天中午去吃了红烧肉，肥而不腻，特别推荐！",images:[],createTime:"2024-03-20 12:30",likes:15,isLiked:!1,showComments:!1,comments:[{id:1,user:{name:"李四",avatar:""},content:"同意，我也觉得很好吃",time:"2024-03-20 12:35"}]}],L=f([{id:1,name:"中央食堂"},{id:2,name:"沁园餐厅"}]),T=f([{id:1,name:"特色炒菜"},{id:2,name:"面食档口"}]),_=()=>{o.value=!0},v=i=>{V.value.images.push(i)},C=async()=>{y.value=!0;try{await new Promise(i=>setTimeout(i,1e3)),k.success("发布成功"),o.value=!1,V.value={type:"recommend",title:"",canteen:"",window:"",dish:"",content:"",images:[]}}catch{k.error("发布失败")}finally{y.value=!1}},g=i=>{i.isLiked=!i.isLiked,i.likes+=i.isLiked?1:-1},P=i=>{i.showComments=!i.showComments},U=async i=>{if(!l.value.trim()){k.warning("请输入评论内容");return}try{const b={id:Date.now(),user:{name:"当前用户",avatar:""},content:l.value,time:new Date().toLocaleString()};i.comments.push(b),l.value="",k.success("评论成功")}catch{k.error("评论失败")}};return Y(()=>{D.value=z}),{posts:D,postDialogVisible:o,posting:y,postForm:V,commentText:l,canteens:L,windows:T,showPostDialog:_,handleImageChange:v,submitPost:C,toggleLike:g,showComments:P,submitComment:U}}},ee={class:"recommendation-square"},te={class:"post-action"},oe={class:"posts-list"},le={class:"post-header"},ne={class:"user-info"},ae={class:"user-detail"},se={class:"username"},ie={class:"post-time"},de={class:"post-content"},me={class:"post-title"},re={class:"location-info"},ce={class:"post-text"},ue={key:0,class:"post-images"},_e={class:"post-actions"},pe=["onClick"],fe=["onClick"],ve={class:"action-item"},ge={key:0,class:"comments-section"},he={class:"comments-list"},we={class:"comment-content"},ke={class:"comment-user"},ye={class:"comment-text"},Ve={class:"comment-time"},Ce={class:"comment-input"};function be(D,o,y,l,V,z){const L=s("back-header"),T=s("Edit"),_=s("el-icon"),v=s("el-button"),C=s("el-avatar"),g=s("el-tag"),P=s("el-image"),U=s("CaretTop"),i=s("ChatDotRound"),b=s("Share"),q=s("el-divider"),F=s("el-input"),I=s("el-card"),S=s("el-radio"),N=s("el-radio-group"),p=s("el-form-item"),E=s("el-option"),B=s("el-select"),A=s("Plus"),M=s("el-upload"),H=s("el-form"),j=s("el-dialog");return r(),u("div",ee,[t(L,{title:"餐品推荐广场"}),a("div",te,[t(v,{type:"primary",onClick:l.showPostDialog},{default:n(()=>[t(_,null,{default:n(()=>[t(T)]),_:1}),o[9]||(o[9]=c(" 发布推荐/避雷 "))]),_:1},8,["onClick"])]),a("div",oe,[(r(!0),u(h,null,w(l.posts,e=>(r(),x(I,{key:e.id,class:"post-card"},{default:n(()=>[a("div",le,[a("div",ne,[t(C,{size:40,src:e.user.avatar},{default:n(()=>[c(d(e.user.name.charAt(0)),1)]),_:2},1032,["src"]),a("div",ae,[a("span",se,d(e.user.name),1),a("span",ie,d(e.createTime),1)])]),t(g,{type:e.type==="recommend"?"success":"danger"},{default:n(()=>[c(d(e.type==="recommend"?"推荐":"避雷"),1)]),_:2},1032,["type"])]),a("div",de,[a("h3",me,d(e.title),1),a("div",re,[t(g,{size:"small"},{default:n(()=>[c(d(e.canteen),1)]),_:2},1024),t(g,{size:"small",type:"info"},{default:n(()=>[c(d(e.window),1)]),_:2},1024),t(g,{size:"small",type:"warning"},{default:n(()=>[c(d(e.dish),1)]),_:2},1024)]),a("p",ce,d(e.content),1),e.images.length?(r(),u("div",ue,[(r(!0),u(h,null,w(e.images,(m,G)=>(r(),x(P,{key:G,src:m,"preview-src-list":e.images,class:"post-image"},null,8,["src","preview-src-list"]))),128))])):R("",!0)]),a("div",_e,[a("div",{class:"action-item",onClick:m=>l.toggleLike(e)},[t(_,{class:Z({active:e.isLiked})},{default:n(()=>[t(U)]),_:2},1032,["class"]),a("span",null,d(e.likes)+"赞",1)],8,pe),a("div",{class:"action-item",onClick:m=>l.showComments(e)},[t(_,null,{default:n(()=>[t(i)]),_:1}),a("span",null,d(e.comments.length)+"评论",1)],8,fe),a("div",ve,[t(_,null,{default:n(()=>[t(b)]),_:1}),o[10]||(o[10]=a("span",null,"分享",-1))])]),e.showComments?(r(),u("div",ge,[t(q,null,{default:n(()=>o[11]||(o[11]=[c("评论区")])),_:1}),a("div",he,[(r(!0),u(h,null,w(e.comments,m=>(r(),u("div",{key:m.id,class:"comment-item"},[t(C,{size:32,src:m.user.avatar},{default:n(()=>[c(d(m.user.name.charAt(0)),1)]),_:2},1032,["src"]),a("div",we,[a("div",ke,d(m.user.name),1),a("div",ye,d(m.content),1),a("div",Ve,d(m.time),1)])]))),128))]),a("div",Ce,[t(F,{modelValue:l.commentText,"onUpdate:modelValue":o[0]||(o[0]=m=>l.commentText=m),placeholder:"写下你的评论...",rows:2,type:"textarea"},null,8,["modelValue"]),t(v,{type:"primary",onClick:m=>l.submitComment(e)},{default:n(()=>o[12]||(o[12]=[c("发表评论")])),_:2},1032,["onClick"])])])):R("",!0)]),_:2},1024))),128))]),t(j,{title:"发布推荐/避雷",modelValue:l.postDialogVisible,"onUpdate:modelValue":o[8]||(o[8]=e=>l.postDialogVisible=e),width:"90%"},{footer:n(()=>[t(v,{onClick:o[7]||(o[7]=e=>l.postDialogVisible=!1)},{default:n(()=>o[15]||(o[15]=[c("取消")])),_:1}),t(v,{type:"primary",onClick:l.submitPost,loading:l.posting},{default:n(()=>o[16]||(o[16]=[c(" 发布 ")])),_:1},8,["onClick","loading"])]),default:n(()=>[t(H,{model:l.postForm,"label-width":"80px"},{default:n(()=>[t(p,{label:"类型"},{default:n(()=>[t(N,{modelValue:l.postForm.type,"onUpdate:modelValue":o[1]||(o[1]=e=>l.postForm.type=e)},{default:n(()=>[t(S,{label:"recommend"},{default:n(()=>o[13]||(o[13]=[c("推荐")])),_:1}),t(S,{label:"warning"},{default:n(()=>o[14]||(o[14]=[c("避雷")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"标题"},{default:n(()=>[t(F,{modelValue:l.postForm.title,"onUpdate:modelValue":o[2]||(o[2]=e=>l.postForm.title=e),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),t(p,{label:"餐厅"},{default:n(()=>[t(B,{modelValue:l.postForm.canteen,"onUpdate:modelValue":o[3]||(o[3]=e=>l.postForm.canteen=e),placeholder:"选择餐厅"},{default:n(()=>[(r(!0),u(h,null,w(l.canteens,e=>(r(),x(E,{key:e.id,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"窗口"},{default:n(()=>[t(B,{modelValue:l.postForm.window,"onUpdate:modelValue":o[4]||(o[4]=e=>l.postForm.window=e),placeholder:"选择窗口"},{default:n(()=>[(r(!0),u(h,null,w(l.windows,e=>(r(),x(E,{key:e.id,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"菜品"},{default:n(()=>[t(F,{modelValue:l.postForm.dish,"onUpdate:modelValue":o[5]||(o[5]=e=>l.postForm.dish=e),placeholder:"输入菜品名称"},null,8,["modelValue"])]),_:1}),t(p,{label:"内容"},{default:n(()=>[t(F,{modelValue:l.postForm.content,"onUpdate:modelValue":o[6]||(o[6]=e=>l.postForm.content=e),type:"textarea",rows:4,placeholder:"详细描述你的体验..."},null,8,["modelValue"])]),_:1}),t(p,{label:"图片"},{default:n(()=>[t(M,{action:"#","list-type":"picture-card","auto-upload":!1,"on-change":l.handleImageChange},{default:n(()=>[t(_,null,{default:n(()=>[t(A)]),_:1})]),_:1},8,["on-change"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const xe=J($,[["render",be],["__scopeId","data-v-e145959d"]]);export{xe as default};
