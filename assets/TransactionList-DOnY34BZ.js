import{_ as w,g as u,U as C,o as B,k as v,n as t,v as l,q as i,w as h,H as V,V as S,A as z,x as f,y as m,z as N,I as L,B as R}from"./index-DxkRXB23.js";const U={name:"TransactionList",setup(){const x=u("month"),s=u(""),_=u([]),e=u(!1),y=u(!0),k=u(99.5),c=u(245.5),p=[{id:1,title:"中央食堂-特色炒菜",amount:15,type:"expense",status:"completed",time:"2024-01-20 12:30:00"},{id:2,title:"余额充值",amount:100,type:"recharge",status:"completed",time:"2024-01-20 10:00:00"},{id:3,title:"沁园餐厅-面食",amount:12,type:"expense",status:"completed",time:"2024-01-19 18:30:00"}],T=C(()=>{const a={};return _.value.forEach(o=>{const r=o.time.split(" ")[0];a[r]||(a[r]=[]),a[r].push(o)}),a}),b=a=>{const o=new Date(a),r=String(o.getMonth()+1).padStart(2,"0"),D=String(o.getDate()).padStart(2,"0");return`${r}月${D}日`},d=a=>a.split(" ")[1].substring(0,5),g=a=>({completed:"交易成功",pending:"处理中",failed:"交易失败"})[a]||a,n=a=>a.filter(o=>o.type==="expense").reduce((o,r)=>o+r.amount,0).toFixed(2),M=async()=>{e.value=!0;try{await new Promise(a=>setTimeout(a,1e3)),_.value.push(...p),y.value=_.value.length<20}finally{e.value=!1}};return B(()=>{_.value=p}),{timeRange:x,transactionType:s,groupedTransactions:T,loading:e,hasMore:y,balance:k,monthlySpent:c,formatDate:b,formatTime:d,getStatusText:g,getDailyTotal:n,loadMore:M}}},q={class:"transaction-list"},E={class:"stats-card"},F={class:"stat-item"},I={class:"value"},A={class:"stat-item"},H={class:"value"},P={class:"filter-bar"},j={class:"transaction-items"},G={class:"date-header"},J={class:"date"},K={class:"daily-total"},O={class:"transaction-content"},Q={class:"left"},W={class:"title"},X={class:"time"},Y={class:"right"},Z={class:"status"},$={key:0,class:"load-more"};function tt(x,s,_,e,y,k){const c=f("el-option"),p=f("el-select"),T=f("el-card"),b=f("el-button");return m(),v("div",q,[t("div",E,[t("div",F,[s[2]||(s[2]=t("div",{class:"label"},"本月消费",-1)),t("div",I,"¥"+l(e.monthlySpent),1)]),t("div",A,[s[3]||(s[3]=t("div",{class:"label"},"剩余余额",-1)),t("div",H,"¥"+l(e.balance),1)])]),t("div",P,[i(p,{modelValue:e.timeRange,"onUpdate:modelValue":s[0]||(s[0]=d=>e.timeRange=d),placeholder:"时间范围",size:"large"},{default:h(()=>[i(c,{label:"最近一周",value:"week"}),i(c,{label:"最近一月",value:"month"}),i(c,{label:"最近三月",value:"quarter"})]),_:1},8,["modelValue"]),i(p,{modelValue:e.transactionType,"onUpdate:modelValue":s[1]||(s[1]=d=>e.transactionType=d),placeholder:"交易类型",size:"large"},{default:h(()=>[i(c,{label:"全部",value:""}),i(c,{label:"消费",value:"expense"}),i(c,{label:"充值",value:"recharge"})]),_:1},8,["modelValue"])]),t("div",j,[(m(!0),v(V,null,S(e.groupedTransactions,(d,g)=>(m(),v("div",{key:g,class:"date-group"},[t("div",G,[t("span",J,l(e.formatDate(g)),1),t("span",K,"支出 ¥"+l(e.getDailyTotal(d)),1)]),(m(!0),v(V,null,S(d,n=>(m(),N(T,{key:n.id,class:"transaction-item"},{default:h(()=>[t("div",O,[t("div",Q,[t("div",W,l(n.title),1),t("div",X,l(e.formatTime(n.time)),1)]),t("div",Y,[t("div",{class:L(["amount",n.type])},l(n.type==="expense"?"-":"+")+"¥"+l(n.amount),3),t("div",Z,l(e.getStatusText(n.status)),1)])])]),_:2},1024))),128))]))),128))]),e.hasMore?(m(),v("div",$,[i(b,{loading:e.loading,onClick:e.loadMore},{default:h(()=>s[4]||(s[4]=[R("加载更多")])),_:1},8,["loading","onClick"])])):z("",!0)])}const at=w(U,[["render",tt],["__scopeId","data-v-df62b958"]]);export{at as default};
